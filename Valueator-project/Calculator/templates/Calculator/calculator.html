{% extends 'base.html' %}
{% load static %}
{% block extrahead %}
<link rel="stylesheet" type="text/css" href="{% static 'css/calculator.css' %}">
{% endblock %}
{% block content %}

<div class="page-container" id="page-body">
    <div class='income-section'>
        <!--Finds income of current user-->
        <h2 class='text-center mb-3'>MONTHLY INCOME</h2>
        <div class='card mb-3'>
        {%if latest_income %}
                <div class='card-body'>
                    <p class='lead'>${{ latest_income.income_text }}</p>
                    
                    <p class='r-income'>Remaining Income: ${{ remainingIncome }}</p>
                    <p class='exp-total'>Expenses: ${{ totalExpenditureCost }}</p>
                </div>
                <form method='POST' action="{% url 'Calculator:addIncome' %}">
                    {% csrf_token %}
                    <div class='form-group'>
                        <label for='add-income'>Update Monthly Income</label>
                        <input class='form-control' id='add-income' name='income_text'>
                    </div>
                    <button type="submit" class="btn btn-primary">Submit</button>
        
                </form>
        {% else %}
            <p>No income available</p>
            <form method='POST' action="{% url 'Calculator:addIncome' %}">
                {% csrf_token %}
                <div class='form-group'>
                    <label for='add-income'>Add Monthly Income</label>
                    <input class='form-control' id='add-income' name='income_text'>
                </div>
                <button type="submit" class="btn btn-primary">Submit</button>

            </form>
        {% endif %}
        </div>
    </div>
    <div class='expenditure-list'>
        <!--Displays a list of expenses from the current user-->
        <h2 class='text-center mb-3'>List of Expenses</h2>
        <div class='card mb-3'>
        {%if latest_expenditure %}
            {% for expenditure in latest_expenditure %}
                    <div class='card-body'>
                        <div class='exp-info'>
                            <p class='exp-name'>{{ expenditure.expenditure_text }}</p>
                            <p class='exp-cost'>${{ expenditure.expenditure_price }}</p>
                        </div>
                    </div>
                    
            {% endfor %}
            <form method='POST' action="{% url 'Calculator:addExpenditure' %}">
                {% csrf_token %}
                <div class='form-group'>
                    <label for='add-expenditure'>Add New Expenditure</label>
                    <input class='form-control' id='add-expenditure' name='expenditure_text'>
                </div>
                <div class='form-group'>
                    <label for='add-expenditure-price'>Cost of Expenditure</label>
                    <input class='form-control' id='add-expenditure-price' name='expenditure_price'>
                </div>
                <div class="form-group col-md-4">
                    <div id="exp-type">
                        <label for="topic_text">Type of Expense</label>
                        <select id="topic_text" class="form-control" name="topic_text">
                        <option selected>Choose...</option>
                        {% for topic in topics_list %}
                        <option>{{topic.topic_text}}</option>
                        {% endfor %}
                        </select>
                    </div>
                </div>

                <div class='form-group col-md-4' id='add-hours'>
                    <label for='add-hours'>Hours used</label>
                    <input class='form-control' id='add-hours' name='sub_hours'>
                </div>
                <button type="submit" class="btn btn-primary">Submit</button>
            </form>
        {% else %}
            <p>No expenditure(s) available</p>
            <form method='POST' action="{% url 'Calculator:addExpenditure' %}">
                {% csrf_token %}
                <div class='form-group'>
                    <label for='add-expenditure'>Add New Expenditure</label>
                    <input class='form-control' id='add-expenditure' name='expenditure_text'>
                </div>
                <div class='form-group'>
                    <label for='add-expenditure-price'>Cost of Expenditure</label>
                    <input class='form-control' id='add-expenditure-price' name='expenditure_price'>
                </div>
                <div class="form-group col-md-4">
                    <div id="exp-type">
                    <label for="topic_text">Type of Expense</label>
                    <select id="topic_text" class="form-control" name="topic_text">
                      <option selected>Choose...</option>
                      {% for topic in topics_list %}
                      <option>{{topic.topic_text}}</option>
                      {% endfor %}
                    </select>
                    </div>
                </div>
                <div class='form-group col-md-4' id='add-hours'>
                    <label for='add-hours'>Hours used</label>
                    <input class='form-control' id='add-hours' name='sub_hours'>
                </div>
                <button type="submit" class="btn btn-primary">Submit</button>
            </form>
        {% endif %}
        </div>
    </div>
    {% endblock %}
</div>